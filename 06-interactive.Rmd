# Interactive component  

#Plot with respect to Race/Age Group/Sex for top1 crimes using mapview
#top 1 crime:ASSAULT 3 & RELATED OFFENSES
#3:Third Degree Assault: when a defendant recklessly causes serious bodily injury or recklessly causes injury with a deadly weapon.
```{r}
library(mapview)
library(leaflet)
dt<-readxl::read_excel("/Users/jessie/Desktop/STAT 5702/Final Project/12 Variables NYPD Arrest Data.xlsx")
dt<-read_excel("/Users/jessie/Desktop/STAT 5702/Final Project/12 Variables NYPD Arrest Data.xlsx")
#Remove NA
dt<-dt[complete.cases(dt),] 

#Renmae variable names
colnames(dt)<-c("id","date","offense","boro","precinct","age","sex","race","X_COORD_CD","Y_COORD_CD","Latitude","Longitude","New Georeferenced Column")

#Rename boro specific
dt$boro <- revalue(dt$boro, c("Q"="Queens", "K"="Brooklyn", "M"="Manhattan", "S"="Staten Island", "B" = "Bronx")) 
top1<-dt[dt$offense=="ASSAULT 3 & RELATED OFFENSES",] #23,731 
top1$boro=as.factor(top1$boro)
top1$sex=as.factor(top1$sex)
top1$race=as.factor(top1$race)
```
#RACE
```{r}
dt1<-st_as_sf(top1,coords = c('Longitude', 'Latitude'),crs = 4326)
a<-mapview(shpdt) +
  mapview(dt1, zcol = "race", col.regions=brewer.pal(7, "RdYlBu"))
a

m <- leaflet() %>%
  addTiles() %>%  # Add default OpenStreetMap map tiles
  addMarkers(lng=174.768, lat=-36.852, popup="The birthplace of R")
m

```
#AGE GROUP
```{r}
b<-mapview(shpdt, col.regions = 'white') +
  mapview(dt1, zcol = "age", col.regions=brewer.pal(5, "RdYlBu"))
b
```
#SEX
```{r}
c<-mapview(shpdt, col.regions = 'white') +
  mapview(dt1, zcol = "sex", col.regions=brewer.pal(2, "Set2"))
c
```


```{r}
library(plotly)
p1 <- ggplot(data = dt, aes(x = sex, fill = age)) +
  geom_bar(position = "dodge")
ggplotly(p1)

p2 <- ggplot(data = dt, aes(x = sex, fill = boro)) +
  geom_bar(position = "dodge")
ggplotly(p2)

p3 <- ggplot(data = dt, aes(x = sex, fill = race)) +
  geom_bar(position = "dodge")
ggplotly(p3)
```